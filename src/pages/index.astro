---
import Layout from "@layouts/Layout.astro";
import { navigation, socials } from "@data/constants";
import { getCollection } from "astro:content";
import Social from "@components/Social.astro";
import Experience from "@components/Experience.astro";
import Project from "@components/Project.astro";
import Link from "@components/Link.astro";

const experience = (await getCollection("experience"))
  // .sort((a, b) => b.data.end_date - a.data.end_date)
  .slice(0, 3);

const projects = (await getCollection("projects"))
  .sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf())
  .slice(0, 3);
---

<Layout>
  <div class="lg:flex lg:justify-between lg:gap-4">
    <div
      class="lg:sticky lg:top-0 lg:flex lg:max-h-screen lg:w-1/2 lg:flex-col lg:justify-between lg:py-24"
    >
      <div>
        <h1
          class="text-4xl font-bold tracking-tight text-slate-200 sm:text-5xl"
        >
          <a href="/">Robert Wong-Sing</a>
        </h1>
        <h2
          id="typewriter"
          class="mt-3 text-lg font-medium tracking-tight text-slate-200 sm:text-xl min-h-7"
        >
        </h2>
        <nav class="nav hidden lg:block">
          <ul class="mt-16 w-max">
            {
              navigation.map((item) => (
                <li>
                  <Link {...item} />
                </li>
              ))
            }
          </ul>
        </nav>
      </div>
      <ul class="ml-1 mt-8 flex items-center">
        {socials.map((s) => <Social {...s} />)}
      </ul>
    </div>
    <section class="pt-24 lg:w-1/2 lg:py-24">
      <section
        id="about"
        class="mb-16 scroll-mt-18 md:mb-24 lg:scroll-mt-24"
        data-scroll="about"
      >
        <p class="mb-4">
          Hello! I'm Robert, a software engineer based in the SF Bay Area. I
          started my coding journey back in 2011 on a website called Scratch.
          Fast-forward to today, and I've had the incredible opportunity to
          contribute to software projects for a
          <a
            class="font-medium text-slate-200 hover:text-amber-500 focus-visible:text-amber-500"
            href="https://www.maxar.com/"
            target="_blank"
            rel="noreferrer noopener">space agency</a
          >, a
          <a
            class="font-medium text-slate-200 hover:text-amber-500 focus-visible:text-amber-500"
            href="https://www.bart.gov/"
            target="_blank"
            rel="noreferrer noopener">public transit system</a
          >, and a
          <a
            class="font-medium text-slate-200 hover:text-amber-500 focus-visible:text-amber-500"
            href="https://www.amyris.com/"
            target="_blank"
            rel="noreferrer noopener">cutting-edge biotech company</a
          >.
        </p>
        <p class="mb-4">
          I love learning new technologies and honing my skills as a software
          engineer. Recently, I've been self-studying AWS and exploring Rust and
          Go.
        </p>
        <p class="mb-4">
          When I'm not hacking away at the keyboard, I'm usually traveling,
          reading a good book, or binge-watching the latest TV show.
        </p>
        <a
          class="inline-flex items-center font-medium leading-tight text-slate-200 font-semibold text-slate-200 group"
          href="/about/"
        >
          <span
            class="border-b border-transparent pb-px transition group-hover:border-amber-500 motion-reduce:transition-none"
          >
            Learn more about me</span
          >
          <span class="whitespace-nowrap">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              viewBox="0 0 20 20"
              fill="currentColor"
              class="ml-1 inline-block h-4 w-4 shrink-0 -translate-y-px transition-transform group-hover:translate-x-2 group-focus-visible:translate-x-2 motion-reduce:transition-none"
              aria-hidden="true"
              ><path
                fill-rule="evenodd"
                d="M3 10a.75.75 0 01.75-.75h10.638L10.23 5.29a.75.75 0 111.04-1.08l5.5 5.25a.75.75 0 010 1.08l-5.5 5.25a.75.75 0 11-1.04-1.08l4.158-3.96H3.75A.75.75 0 013 10z"
                clip-rule="evenodd"></path></svg
            >
          </span>
        </a>
      </section>
      <section
        id="experience"
        class="mb-16 scroll-mt-18 md:mb-24 lg:scroll-mt-24"
        data-scroll="experience"
      >
        <ul class="mt-6 grid grid-cols-1 gap-5">
          {experience.map((exp) => <Experience minimal {...exp} />)}
        </ul>
        <a
          class="inline-flex items-baseline font-medium leading-tight text-slate-200 hover:text-amber-500 focus-visible:text-amber-500 font-semibold text-slate-200 group/link text-base"
          href="/static/resume.pdf"
          download="Robert_WongSing_Resume"
        >
          <span>
            View Full Resume
            <span class="inline-block">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 20 20"
                fill="currentColor"
                class="inline-block h-4 w-4 shrink-0 transition-transform group-hover/link:-translate-y-1 group-hover/link:translate-x-1 group-focus-visible/link:-translate-y-1 group-focus-visible/link:translate-x-1 motion-reduce:transition-none ml-1 translate-y-px"
                aria-hidden="true"
                ><path
                  fill-rule="evenodd"
                  d="M5.22 14.78a.75.75 0 001.06 0l7.22-7.22v5.69a.75.75 0 001.5 0v-7.5a.75.75 0 00-.75-.75h-7.5a.75.75 0 000 1.5h5.69l-7.22 7.22a.75.75 0 000 1.06z"
                  clip-rule="evenodd"></path></svg
              >
            </span>
          </span>
        </a>
      </section>
      <section
        id="projects"
        class="mb-16 scroll-mt-18 md:mb-24 lg:scroll-mt-24"
        data-scroll="projects"
      >
        <ul class="mt-6 grid grid-cols-1 gap-5">
          {projects.map((proj) => <Project {...proj} />)}
        </ul>
        <a
          class="inline-flex items-center font-medium leading-tight text-slate-200 font-semibold text-slate-200 group"
          href="/projects/"
        >
          <span
            class="border-b border-transparent pb-px transition group-hover:border-amber-500 motion-reduce:transition-none"
          >
            View Full Project Archive</span
          >
          <span class="whitespace-nowrap">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              viewBox="0 0 20 20"
              fill="currentColor"
              class="ml-1 inline-block h-4 w-4 shrink-0 -translate-y-px transition-transform group-hover:translate-x-2 group-focus-visible:translate-x-2 motion-reduce:transition-none"
              aria-hidden="true"
              ><path
                fill-rule="evenodd"
                d="M3 10a.75.75 0 01.75-.75h10.638L10.23 5.29a.75.75 0 111.04-1.08l5.5 5.25a.75.75 0 010 1.08l-5.5 5.25a.75.75 0 11-1.04-1.08l4.158-3.96H3.75A.75.75 0 013 10z"
                clip-rule="evenodd"></path></svg
            >
          </span>
        </a>
      </section>
      <footer class="max-w-md pb-16 text-sm text-slate-500 sm:pb-0">
        <p>
          Coded in <a
            class="font-medium text-slate-400 hover:text-amber-500 focus-visible:text-amber-500"
            href="https://code.visualstudio.com/"
            target="_blank"
            rel="noreferrer noopener">Visual Studio Code</a
          >. Built with <a
            class="font-medium text-slate-400 hover:text-amber-500 focus-visible:text-amber-500"
            href="https://astro.build/"
            target="_blank"
            rel="noreferrer noopener">Astro</a
          > and <a
            class="font-medium text-slate-400 hover:text-amber-500 focus-visible:text-amber-500"
            href="https://tailwind.build/"
            target="_blank"
            rel="noreferrer noopener">Tailwind CSS</a
          >, deployed with
          <a
            class="font-medium text-slate-400 hover:text-amber-500 focus-visible:text-amber-500"
            href="https://pages.github.com/"
            target="_blank"
            rel="noreferrer noopener">Github Pages</a
          >.
        </p>
      </footer>
    </section>
  </div>
</Layout>

<script>
  const textList = [
    "Software Engineer",
    "Full Stack Developer",
    "Video Game Enthusiast",
    "Spongebob Fanatic",
  ];
  let currentStringIndex = 0;

  async function typeWriterEffect() {
    const element = document.getElementById("typewriter");
    const currentString = textList[currentStringIndex];
    const typingSpeed = 100; // Adjust typing speed
    const eraseSpeed = 50; // Adjust erasing speed
    const delayBeforeTypingNext = 1000; // Delay before typing the next string

    async function type() {
      for (let i = 0; i <= currentString.length; i++) {
        element.textContent = currentString.substring(0, i);
        await new Promise((resolve) => setTimeout(resolve, typingSpeed));
      }

      await new Promise((resolve) =>
        setTimeout(resolve, delayBeforeTypingNext)
      );

      for (let i = currentString.length; i >= 0; i--) {
        element.textContent = currentString.substring(0, i);
        await new Promise((resolve) => setTimeout(resolve, eraseSpeed));
      }

      // Increment the index for the next string
      currentStringIndex = (currentStringIndex + 1) % textList.length;

      // Continue with the next string
      typeWriterEffect();
    }

    type();
  }

  // Start the typewriter effect
  typeWriterEffect();
</script>
